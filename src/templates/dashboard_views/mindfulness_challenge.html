<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mindfulness Challenge</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    /* Animations */
    @keyframes fadeIn { from {opacity:0;} to {opacity:1;} }
    @keyframes slideInDown { from {opacity:0; transform: translateY(-40px);} to {opacity:1; transform: translateY(0);} }
    @keyframes slideInUp { from {opacity:0; transform: translateY(40px);} to {opacity:1; transform: translateY(0);} }
    @keyframes pulseScale { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.05); } }
    @keyframes confettiDrop {
      0% { transform: translateY(-50px) rotate(0deg); opacity:1; }
      100% { transform: translateY(300px) rotate(360deg); opacity:0; }
    }

    /* Tailwind custom classes */
    .animate-fadeIn { animation: fadeIn 0.6s ease-out; }
    .animate-slideInDown { animation: slideInDown 0.6s ease-out; }
    .animate-slideInUp { animation: slideInUp 0.6s ease-out; }
    .animate-pulseScale { animation: pulseScale 1s infinite; }
    .confetti { animation: confettiDrop 2s linear infinite; position: absolute; }

  </style>
</head>
<body class="bg-gradient-to-br from-sky-50 to-indigo-50 min-h-screen flex items-center justify-center relative overflow-hidden p-6">

  <!-- Confetti -->
  {% if success_msg %}
    <div class="absolute top-0 left-0 w-full h-full pointer-events-none overflow-hidden">
      {% for i in range(50) %}
        <span class="confetti">🎉✨🎊💫🌟</span>
      {% endfor %}
    </div>
  {% endif %}

<!-- Main Card -->
<div class="w-full max-w-md bg-white/90 backdrop-blur-md rounded-3xl shadow-2xl p-10 flex flex-col items-center gap-8 animate-fadeIn mx-auto my-auto">

    <h1 class="text-4xl font-extrabold text-sky-600 text-center animate-slideInDown">🌱 Mindfulness Challenge</h1>

    {% if not accepted_challenge %}
      <form method="post" action="/mindfulness_challenge" class="w-full flex flex-col items-center gap-4">
        <button type="submit" name="form_type" value="get_challenge"
          class="bg-sky-400 hover:bg-sky-500 text-white font-bold w-full py-4 rounded-2xl shadow-lg transform transition duration-300 hover:scale-105 hover:shadow-2xl">
          Get your daily mindfulness challenge!
        </button>
      </form>

    {% else %}
      <div class="flex flex-col items-center gap-6 w-full text-center">
        <h3 class="text-2xl md:text-3xl font-bold text-sky-700 animate-slideInDown animate-pulseScale">{{ challenge }}</h3>

        <form method="post" action="/mindfulness_challenge" class="w-full flex justify-center">
          <button type="submit" name="form_type" value="finish_challenge"
            class="bg-sky-400 hover:bg-sky-500 text-white font-semibold py-3 px-8 rounded-2xl shadow-lg transform transition duration-300 hover:scale-105 hover:shadow-2xl">
            Finish Challenge
          </button>
        </form>

        {% if success_msg %}
          <div class="mt-6 flex flex-col items-center gap-2 animate-slideInUp">
            <h2 class="text-2xl md:text-3xl font-extrabold text-green-500 animate-pulseScale">{{ success_msg }}</h2>
            <p class="text-gray-700 text-center text-lg md:text-xl">🎉 Amazing! You completed the challenge! Keep practicing mindfulness daily! 🌟</p>
          </div>
        {% endif %}
      </div>
    {% endif %}

  </div>

  <!-- Mega Confetti Script -->
  <script>
    const confettis = document.querySelectorAll('.confetti');   
    const colors = ['#f97316','#22c55e','#3b82f6','#eab308','#ec4899','#f43f5e','#8b5cf6','#14b8a6'];
    const emojis = ['🎉','✨','🎊','💫','🌟','🎈','🥳','🍀','💖'];

    confettis.forEach(el => {
      el.style.left = Math.random() * window.innerWidth + 'px';
      el.style.top = Math.random() * -100 + 'px';
      el.style.fontSize = (14 + Math.random() * 28) + 'px';
      el.style.color = colors[Math.floor(Math.random() * colors.length)];
      el.textContent = emojis[Math.floor(Math.random() * emojis.length)];
      el.style.animationDelay = Math.random() * 2 + 's';
      el.style.transform = `rotate(${Math.random() * 360}deg)`;
    });
  </script>

</body>
</html>
